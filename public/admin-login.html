<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>دخول الإدارة</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Sans",Tahoma,Arial}
    .card{max-width:740px;margin:40px auto;background:#fff;border:1px solid #eee;border-radius:14px;box-shadow:0 6px 22px rgba(0,0,0,.05);padding:22px 26px}
    .title{font-size:28px;font-weight:800;margin:6px 0 18px}
    .input{width:100%;height:44px;border:1px solid #e2e2e2;border-radius:10px;padding:0 12px;background:#fff;margin:10px 0}
    .btn{height:44px;border:0;border-radius:999px;padding:0 18px;font-weight:700;cursor:pointer}
    .btn-primary{background:#8b0016;color:#fff}
    .row{display:flex;gap:10px;align-items:center}
    .muted{color:#777;font-size:13px}
  </style>
</head>
<body>
  <header style="max-width:1040px;margin:10px auto 0;display:flex;align-items:center;gap:14px">
    <img src="/assets/logo-alasala.png" alt="ALASALA" style="height:36px">
    <div style="font-weight:800">منصة الاختبارات – كليات الأصالة</div>
  </header>

  <main class="card">
    <div class="title">لوحة الإدارة</div>
    <div class="muted" style="margin:-8px 0 14px">أدخل بيانات حساب الإدارة.</div>
    <input id="u" class="input" placeholder="اسم المستخدم" autocomplete="username" autofocus>
    <input id="p" class="input" placeholder="كلمة المرور" type="password" autocomplete="current-password">
    <div class="row" style="justify-content:flex-start;margin-top:8px">
      <button id="loginBtn" class="btn btn-primary">دخول الإدارة</button>
    </div>
    <div id="msg" class="muted" style="margin-top:10px"></div>
  </main>

<script>
const api = (path, opt={}) =>
  fetch(path, Object.assign({headers:{'Content-Type':'application/json'}}, opt)).then(r=>r.json());

document.getElementById('loginBtn').addEventListener('click', async () => {
  const username = document.getElementById('u').value.trim();
  const password = document.getElementById('p').value;
  const msg = document.getElementById('msg');
  msg.textContent = '...جاري التحقق';
  try {
    const res = await api('/api/auth/login', {method:'POST', body: JSON.stringify({username, password})});
    if (res && res.ok && res.token) {
      // حفظ الرمز
      localStorage.setItem('asz_token', res.token);
      // التوجيه إلى صفحة التحكم (dashboard)
      window.location.href = '/dashboard.html';
    } else {
      msg.textContent = 'بيانات غير صحيحة أو لم يتم اعتماد الحساب.';
    }
  } catch (e) {
    msg.textContent = 'تعذّر الاتصال بالخادم. حاول لاحقًا.';
  }
});
</script>
</body>
</html>
